<div id="3d-graph" style="width: 100vw; height: 100vh;"></div>
<div id="node-content" style="
  position: absolute;
  top: 10px;
  left: 10px;
  width: 400px;
  background: white;
  padding: 1em;
  border-radius: 10px;
  box-shadow: 0 0 10px rgba(0,0,0,0.3);
  display: none;
  z-index: 10;
"></div>

<!-- Load ForceGraph from working CDN -->
<script src="https://unpkg.com/3d-force-graph@1.70.6/dist/3d-force-graph.min.js"></script>

<script>
  window.addEventListener('DOMContentLoaded', () => {
    console.log("‚úÖ DOM fully loaded");

    // Check if ForceGraph is defined
    if (typeof ForceGraph !== 'function') {
      console.error("‚ùå ForceGraph is NOT defined. Check the script src.");
      return;
    } else {
      console.log("‚úÖ ForceGraph is defined and ready");
    }

    // Fetch graph data
    fetch('graph.json')
      .then(res => {
        console.log("üì• graph.json fetched successfully");
        return res.json();
      })
      .then(data => {
        console.log("üì¶ graph.json parsed:", data);

        // Initialize ForceGraph
        const Graph = ForceGraph()(document.getElementById('3d-graph'))
          .graphData(data)
          .nodeAutoColorBy('group')
          .nodeLabel('id')
          .onNodeClick(node => {
            console.log("üß† Node clicked:", node.id);
            const contentDiv = document.getElementById('node-content');
            contentDiv.innerHTML = `
              <h2>${node.id}</h2>
              <p>${node.content || 'No content available.'}</p>
            `;
            contentDiv.style.display = 'block';
          });

        console.log("üöÄ ForceGraph initialized and running");
      })
      .catch(err => {
        console.error("‚ùå Error loading or parsing graph.json:", err);
      });
  });
</script>
